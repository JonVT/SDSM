{{define "cards/server_status_info.html"}}
<div class="card card-server-info"
    id="card-server-status-info"
    data-card-id="server-status-info"
    hx-get="/server/{{.server.ID}}/cards/server-status-info"
    hx-trigger="sdsm:card-refresh[event.detail.cardId == 'server-status-info'] from:body"
    hx-target="this"
    hx-swap="outerHTML">
    <div class="card-header server-info-header">
        <div class="server-info-heading">
            <p class="card-eyebrow text-xs uppercase tracking-wide text-muted">Server</p>
            <h1 class="card-title" id="server-name-display">{{.server.Name}}</h1>
            <p class="text-sm text-muted">ID #{{.server.ID}}</p>
        </div>
        <div class="server-info-actions flex flex-col gap-2 sm:flex-row sm:items-center">
            <button type="button" id="btn-rename-server" class="btn btn-sm btn-secondary">
                <i data-feather="edit-2" class="btn-icon-left"></i> Rename
            </button>
            {{if .language_options}}
            <div class="language-select">
                <label for="server-language-select" class="form-label text-xs text-muted">Language</label>
                <select id="server-language-select" class="form-control form-control-sm" aria-label="Select server language">
                    {{range .language_options}}
                    <option value="{{.}}" {{if eq $.server.Language .}}selected{{end}}>{{.}}</option>
                    {{end}}
                </select>
            </div>
            {{end}}
        </div>
    </div>
    <div class="card-body">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <section class="info-panel">
                <div class="info-label">World</div>
                <div class="info-value">
                    {{if .worldInfo.Name}}{{.worldInfo.Name}}{{else}}{{.server.World}}{{end}}
                    {{if .server.Beta}}
                    <span class="badge badge-warning ml-2">Beta</span>
                    {{end}}
                </div>
                {{if .worldInfo.Description}}
                <p class="info-description">{{.worldInfo.Description}}</p>
                {{else if .server.World}}
                <p class="info-description text-muted">{{.server.World}}</p>
                {{end}}
            </section>
            <section class="info-panel">
                <div class="info-label">Starting Location</div>
                <div class="info-value">
                    {{with .start_location_info}}
                        {{$name := index . "name"}}
                        {{$id := index . "id"}}
                        {{if $name}}
                            {{$name}}
                        {{else if $id}}
                            {{$id}}
                        {{else}}
                            —
                        {{end}}
                    {{else}}
                        {{if .server.StartLocation}}
                            {{.server.StartLocation}}
                        {{else}}
                            —
                        {{end}}
                    {{end}}
                </div>
                {{with .start_location_info}}
                    {{$desc := index . "description"}}
                    {{if $desc}}<p class="info-description">{{$desc}}</p>{{end}}
                {{end}}
                <div class="info-label mt-4">Starting Condition</div>
                <div class="info-value">
                    {{with .start_condition_info}}
                        {{$name := index . "name"}}
                        {{$id := index . "id"}}
                        {{if $name}}
                            {{$name}}
                        {{else if $id}}
                            {{$id}}
                        {{else}}
                            —
                        {{end}}
                    {{else}}
                        {{if .server.StartCondition}}
                            {{.server.StartCondition}}
                        {{else}}
                            —
                        {{end}}
                    {{end}}
                </div>
                {{with .start_condition_info}}
                    {{$desc := index . "description"}}
                    {{if $desc}}<p class="info-description">{{$desc}}</p>{{end}}
                {{end}}
            </section>
        </div>
        <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 mt-6">
            <div class="info-stat">
                <div class="info-label">Difficulty</div>
                <div class="info-value">
                    {{if .server.Difficulty}}{{.server.Difficulty}}{{else}}Normal{{end}}
                </div>
            </div>
            <div class="info-stat">
                <div class="info-label">Port</div>
                <div class="info-value">
                    {{if gt .server.Port 0}}{{.server.Port}}{{else}}—{{end}}
                </div>
            </div>
            <div class="info-stat">
                <div class="info-label">Players</div>
                <div class="info-value">
                    {{len .server.LiveClients}} / {{if gt .server.MaxClients 0}}{{.server.MaxClients}}{{else}}?{{end}}
                </div>
            </div>
        </div>
    </div>
</div>
{{end}}
