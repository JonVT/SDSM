{{define "server_status_players.html"}}
<div class="card card-players">
    <div class="card-header">
        <h2 class="card-title">Players</h2>
        <div class="tabs" role="tablist">
            <button class="tab active" id="tab-live" role="tab" aria-selected="true" aria-controls="players-live-panel">
                Live <span class="badge" id="live-count">{{len .server.LiveClients}}</span>
            </button>
            <button class="tab" id="tab-history" role="tab" aria-selected="false" aria-controls="players-history-panel">
                History <span class="badge" id="history-count">{{len .server.Clients}}</span>
            </button>
            {{if eq .role "admin"}}
            <button class="tab" id="tab-banned" role="tab" aria-selected="false" aria-controls="players-banned-panel">
                Banned <span class="badge" id="banned-count">{{len .server.BannedClients}}</span>
            </button>
            {{end}}
        </div>
    </div>

    <div class="card-body p-0">
        <div id="players-live-panel" role="tabpanel" aria-labelledby="tab-live">
            <div class="table-container">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>GUID</th>
                            <th>IP</th>
                            <th>Joined</th>
                            {{if eq .role "admin"}}<th class="text-right">Actions</th>{{end}}
                        </tr>
                    </thead>
                    <tbody id="live-players-table">
                        {{range .server.LiveClients}}
                            <tr id="live-player-{{.GUID}}">
                                <td>{{.Name}}</td>
                                <td><code class="text-xs">{{.GUID}}</code></td>
                                <td>{{.IP}}</td>
                                <td>{{.Connected}}</td>
                                {{if eq $.role "admin"}}
                                <td class="text-right">
                                    <button class="btn btn-icon btn-sm btn-danger btn-kick" data-guid="{{.GUID}}" title="Kick Player"><i data-feather="x-circle"></i></button>
                                    <button class="btn btn-icon btn-sm btn-warning btn-ban" data-guid="{{.GUID}}" title="Ban Player"><i data-feather="slash"></i></button>
                                </td>
                                {{end}}
                            </tr>
                        {{end}}
                    </tbody>
                </table>
            </div>
            <div id="live-players-empty" class="empty-state {{if .server.LiveClients}}hidden{{end}}">
                <i data-feather="users"></i>
                <h3 class="empty-state-title">No Players Online</h3>
                <p class="empty-state-description">Players will appear here when they join the server.</p>
            </div>
        </div>

        <div id="players-history-panel" role="tabpanel" aria-labelledby="tab-history" class="hidden">
            <div class="table-container">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>GUID</th>
                            <th>Last Seen</th>
                            {{if eq .role "admin"}}<th class="text-right">Actions</th>{{end}}
                        </tr>
                    </thead>
                    <tbody id="history-players-table">
                        {{range .server.Clients}}
                            <tr id="history-player-{{.GUID}}">
                                <td>{{.Name}}</td>
                                <td><code class="text-xs">{{.GUID}}</code></td>
                                <td>{{.LastSeen.Format "Jan 2, 2006 3:04 PM"}}</td>
                                {{if eq $.role "admin"}}
                                <td class="text-right">
                                    <button class="btn btn-icon btn-sm btn-warning btn-ban" data-guid="{{.GUID}}" title="Ban Player"><i data-feather="slash"></i></button>
                                </td>
                                {{end}}
                            </tr>
                        {{end}}
                    </tbody>
                </table>
            </div>
            <div id="history-players-empty" class="empty-state {{if .server.Clients}}hidden{{end}}">
                <i data-feather="clock"></i>
                <h3 class="empty-state-title">No Player History</h3>
                <p class="empty-state-description">Player history is not enabled or no players have joined yet.</p>
            </div>
        </div>

        {{if eq .role "admin"}}
        <div id="players-banned-panel" role="tabpanel" aria-labelledby="tab-banned" class="hidden">
            <div class="table-container">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>GUID</th>
                            <th>Banned On</th>
                            <th class="text-right">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="banned-players-table">
                        {{range .server.BannedClients}}
                            <tr id="banned-player-{{.GUID}}">
                                <td>{{.Name}}</td>
                                <td><code class="text-xs">{{.GUID}}</code></td>
                                <td>{{.BannedOn.Format "Jan 2, 2006 3:04 PM"}}</td>
                                <td class="text-right">
                                    <button class="btn btn-icon btn-sm btn-success btn-unban" data-guid="{{.GUID}}" title="Unban Player"><i data-feather="check-circle"></i></button>
                                </td>
                            </tr>
                        {{end}}
                    </tbody>
                </table>
            </div>
            <div id="banned-players-empty" class="empty-state {{if .server.BannedClients}}hidden{{end}}">
                <i data-feather="slash"></i>
                <h3 class="empty-state-title">No Banned Players</h3>
                <p class="empty-state-description">You can ban players from the Live or History tabs.</p>
            </div>
        </div>
        {{end}}
    </div>
</div>

<template id="live-player-row-template">
    <tr id="live-player-{{.GUID}}">
        <td>{{.Name}}</td>
        <td><code class="text-xs">{{.GUID}}</code></td>
        <td>{{.IP}}</td>
        <td>{{.Connected}}</td>
        {{if eq $.role "admin"}}
        <td class="text-right">
            <button class="btn btn-icon btn-sm btn-danger btn-kick" data-guid="{{.GUID}}" title="Kick Player"><i data-feather="x-circle"></i></button>
            <button class="btn btn-icon btn-sm btn-warning btn-ban" data-guid="{{.GUID}}" title="Ban Player"><i data-feather="slash"></i></button>
        </td>
        {{end}}
    </tr>
</template>

<template id="history-player-row-template">
    <tr id="history-player-{{.GUID}}">
        <td>{{.Name}}</td>
        <td><code class="text-xs">{{.GUID}}</code></td>
        <td>{{.LastSeen}}</td>
        {{if eq $.role "admin"}}
        <td class="text-right">
            <button class="btn btn-icon btn-sm btn-warning btn-ban" data-guid="{{.GUID}}" title="Ban Player"><i data-feather="slash"></i></button>
        </td>
        {{end}}
    </tr>
</template>

<template id="banned-player-row-template">
    <tr id="banned-player-{{.GUID}}">
        <td>{{.Name}}</td>
        <td><code class="text-xs">{{.GUID}}</code></td>
        <td>{{.BannedOn}}</td>
        <td class="text-right">
            <button class="btn btn-icon btn-sm btn-success btn-unban" data-guid="{{.GUID}}" title="Unban Player"><i data-feather="check-circle"></i></button>
        </td>
    </tr>
</template>
{{end}}

