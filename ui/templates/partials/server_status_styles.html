<style>
    /* Lightweight modal styles (scoped to this page) */
    .confirm-modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.5);z-index:1000}
    .confirm-modal.active{display:flex}
    .confirm-modal .modal-card{max-width:520px;width:92%;background:var(--panel-gradient);color:var(--text-primary);border:1px solid var(--panel-border);border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,.35)}
    .confirm-modal .modal-header{padding:16px 20px;border-bottom:1px solid var(--panel-border);display:flex;align-items:center;gap:10px}
    .confirm-modal .modal-header .icon{width:20px;height:20px;color:var(--danger-500)}
    .confirm-modal .modal-title{font-size:16px;font-weight:600;margin:0}
    .confirm-modal .modal-body{padding:16px 20px;line-height:1.5}
    .confirm-modal .modal-actions{padding:16px 20px;border-top:1px solid var(--panel-border);display:flex;gap:10px;justify-content:flex-end}
    .btn-danger-ghost{background:transparent;border:1px solid var(--danger-500);color:var(--danger-500)}

    /* More/expand section for Server Control card */
    .card-control .card-more-footer{display:flex;justify-content:flex-start;align-items:center;margin-top:var(--space-2)}
    .card-control .card-more-link{background:none;border:none;color:var(--text-tertiary);text-decoration:underline;cursor:pointer;font:inherit;padding:0}
    .card-control .card-more-link:hover{color:var(--text-primary)}
    .card-control .card-more-section{display:none;margin-top:var(--space-3);padding-top:var(--space-3);border-top:1px solid var(--panel-border)}
    .card-control.expanded .card-more-section{display:block}

    /* Language dropdown anchored to the language button; ensure it can layer over other cards */
    .lang-dropdown {
        position: absolute; /* anchored to .lang-control wrapper */
        right: 0;
        top: calc(100% + 6px);
        display: none;
        min-width: 180px;
        background: var(--bg-secondary);
        color: var(--text-primary);
        border: 1px solid var(--border-color);
        border-radius: var(--radius-md);
        box-shadow: var(--shadow-lg);
        padding: 6px;
        z-index: 7000; /* ensure above standard cards; kept below global toasts (9999) */
    }
    .lang-dropdown.active { display: block; }
    .lang-dropdown .menu-item {
        display: block;
        width: 100%;
        text-align: left;
        padding: 8px 10px;
        border-radius: var(--radius-sm);
        border: none;
        background: transparent;
        color: var(--text-secondary);
        font: inherit;
        cursor: pointer;
    }
    .lang-dropdown .menu-item:hover {
        background: var(--surface-soft);
        color: var(--text-primary);
    }

    /* Lift the Server Info card's stacking context so the dropdown can overlay subsequent cards */
    .server-content > .glass-card {
        position: relative; /* already set globally, restated for clarity */
        z-index: 6000; /* above other cards/grids on the page, below toasts/modals */
        overflow: visible; /* prevent any accidental clipping around the title bar */
    }

    /* Split button styling for Save/Save As */
    /* Render caret overlayed so total width matches a single control button */
    .split-button { display: inline-block; position: relative; vertical-align: middle; border-radius: var(--radius-full); overflow: hidden; }
    .button-group .split-button { margin: 0; }
    /* Remove pill radii and margins from inner halves so they render as one control */
    .split-button > .btn { margin: 0; border-radius: 0 !important; box-shadow: none; }
    /* Ensure split-button halves match other control button heights */
    .card-control .button-group .btn-control,
    .card-control .split-button > .btn { min-height: 36px; }
    /* Keep only outer corners rounded to match pill buttons */
    .split-button > .btn:first-child { border-top-left-radius: var(--radius-full) !important; border-bottom-left-radius: var(--radius-full) !important; border-right: 0; padding-right: calc(var(--space-4) + 38px); /* leave room for caret overlay */ }
    .split-button > .btn:last-of-type { border-top-right-radius: var(--radius-full) !important; border-bottom-right-radius: var(--radius-full) !important; }
    /* Position caret overlayed on the right, not increasing overall width */
    .split-button > .btn.btn-split-caret {
        position: absolute; right: 0; top: 0; bottom: 0; z-index: 2;
        width: 38px; min-width: 38px !important; padding-left: 0; padding-right: 0;
        display: inline-flex; align-items: center; justify-content: center;
        border-left: 1px solid var(--border-color) !important;
    }
    /* Match divider color to primary variant so seam blends with button color */
    .split-button > .btn.btn-primary.btn-split-caret { border-left-color: rgba(59, 130, 246, 0.42) !important; }
    /* Prevent hover lift that visually splits the halves */
    .split-button > .btn:hover,
    .split-button > .btn:focus { transform: none !important; box-shadow: none !important; }
    .split-button .btn-split-caret svg { pointer-events: none; }

    /* Keep button gradient styling; rely on :disabled opacity. Only the dropdown panel swaps to neutral when disabled. */
    /* Ensure caret half visually dims even if disabled state is controlled at the group level */
    #save-split.is-disabled > .btn.btn-split-caret { opacity: 0.55; pointer-events: none; }
    .split-button > .btn[disabled] + .btn { opacity: .9; }

    /* Dropdown animation & interaction improvements (applies to language/save menus) */
    .lang-dropdown { transition: opacity 120ms ease, transform 120ms ease; opacity: 0; transform: translateY(-6px); pointer-events: none; }
    .lang-dropdown.active { display: block; opacity: 1; transform: translateY(0); pointer-events: auto; }

    /* Save As uses shared prompt modal; specific icon color rule removed */

    /* Fixed label width for More-section rows to align controls */
    .card-more-section .more-label { flex: 0 0 160px; }

    /* Save split dropdown: match the primary button look */
    #save-split #save-menu {
        background: linear-gradient(125deg, var(--primary-500) 0%, var(--primary-600) 100%);
        color: #f8fafc;
        border-color: rgba(59, 130, 246, 0.42);
        border-radius: var(--radius-md);
        box-shadow: var(--shadow-lg);
        padding: 6px;
    }
    /* Ensure Save split can display dropdown outside its bounds */
    #save-split { overflow: visible; z-index: 6500; }
    /* When save controls are disabled, reflect neutral panel color */
    #save-split.is-disabled #save-menu {
        background: var(--bg-secondary);
        color: var(--text-secondary);
        border-color: var(--border-color);
    }
    #save-split #save-menu .dropdown-item {
        display: block;
        width: 100%;
        text-align: left;
        padding: 8px 10px;
        border: none;
        background: transparent;
        color: #f8fafc;
        border-radius: var(--radius-sm);
        font: inherit;
        cursor: pointer;
    }
    #save-split #save-menu .dropdown-item:hover {
        background: rgba(255, 255, 255, 0.12);
    }
    #save-split.is-disabled #save-menu .dropdown-item:hover {
        background: var(--surface-soft);
        color: var(--text-primary);
    }

    /* Server Configuration: widen first column, narrow second for dual-field rows */
    .card-config .grid-2 { grid-template-columns: 1.6fr 1fr; }
    @media (max-width: 780px) {
        /* Preserve stacking on narrow screens */
        .card-config .grid-2 { grid-template-columns: 1fr; }
    }

    /* Server Configuration: tighten vertical rhythm and align numeric inputs */
    .card-config .form-grid-compact { gap: var(--space-2); }
    .card-config .form-row { gap: var(--space-2); }
    /* Option A: use vertical labels on non-grid rows (label above input) */
    .card-config .form-row:not(.grid-2) { grid-template-columns: 1fr; align-items: start; }
    .card-config .form-row:not(.grid-2) > label { margin-bottom: 4px; }
    .card-config input.form-input-inline[type="number"] { width: 160px; max-width: 160px; }
    @media (max-width: 780px) {
        .card-config input.form-input-inline[type="number"] { width: 100%; max-width: none; }
    }

    /* Removed separate token row; tokens button now inline with delay input */
    .card-config .message-delay-row .row-controls { display: flex; align-items: center; gap: var(--space-2); justify-content: space-between; width: 100%; }

    /* Utility classes (scoped) replacing previous inline styles */
    .ml-6 { margin-left: 6px; }
    .console-command-group { display: flex; gap: 8px; align-items: center; width: 100%; }
    .flex-grow-input { flex: 1; min-width: 0; }
    .checkbox-group { display: flex; flex-wrap: wrap; gap: var(--space-3); }
    .inline-form { display: inline; }
    .input-wide { min-width: 240px; }
    .checkbox-row { display: block; }

    /* Rename modal now uses shared template sizing; custom rule removed */

    /* Align rename + language controls to the right, side by side */
    .right-title-actions { display: inline-flex; align-items: center; gap: var(--space-2); }
</style>
